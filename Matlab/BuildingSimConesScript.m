%% Simulation data
Yxy=[-17400	-12840
-17003.166	-12888.217
-16604.928	-12933.579
-16208.467	-12988.76
-15823	-13091.754
-15530.292	-13357.764
-15248.748	-13643.225
-14993.489	-13951.902
-14811.875	-14306.13
-14730.254	-14696.81
-14662.855	-15090.656
-14633.386	-15488.105
-14743.054	-15867.673
-14970.758	-16197.399
-15231.626	-16502.219
-15495.977	-16804.311
-15740.521	-17121.336
-15904.498	-17483.424
-15942.033	-17878.619
-15843.76	-18264.594
-15617.23	-18589.406
-15321.92	-18860.133
-15078.214	-19173.863
-14932.718	-19546.039
-14862.102	-19938.859
-14888.204	-20336.994
-14994.789	-20721.941
-15156.386	-21087.668
-15367.702	-21426.883
-15654.467	-21702.902
-15981.679	-21934.445
-16299.359	-22177.797
-16520.721	-22503.623
-16523.406	-22899.959
-16461.189	-23295.262
-16513.148	-23687.797
-16686.754	-24047.82
-16887.625	-24394.707
-17060.133	-24755.047
-17098.848	-25148.898
-17008.254	-25538.213
-16987.324	-25933.406
-17091.346	-26319.574
-17263.188	-26680.23
-17514.832	-26989.113
-17829.678	-27235.105
-18187.791	-27411.295
-18573.4	-27512.471
-18970.303	-27568.053
-19370.211	-27571.658
-19760.887	-27490.391
-20103.973	-27290.1
-20401.525	-27022.195
-20654.357	-26711.742
-20833.879	-26357.062
-20855.609	-25960.809
-20742.555	-25578.121
-20533.543	-25237.943
-20214.486	-25004.809
-19842.281	-24856.766
-19472.559	-24703.357
-19155.652	-24463.256
-18897.627	-24158.609
-18707.209	-23807.957
-18595.814	-23425.277
-18555.762	-23027.23
-18555.656	-22626.543
-18583.943	-22227.258
-18645.088	-21832.227
-18784.523	-21459.898
-18985.496	-21114.277
-19189.582	-20772.297
-19415.885	-20440.945
-19643.561	-20110.535
-19859.613	-19773.018
-20045.008	-19417.896
-20164.439	-19037.936
-20220.154	-18642.785
-20194.086	-18244.975
-20086.4	-17860.574
-19887.262	-17515.803
-19634.934	-17204.195
-19368.613	-16904.092
-19113.984	-16595.41
-18912.947	-16251.479
-18804.965	-15871.309
-18813.844	-15475.224
-18888.195	-15080.443
-18988.736	-14691.065
-19087.863	-14302.223
-19166.598	-13909.848
-19184.43	-13511.515
-18996.143	-13173.868
-18630.883	-13019.508
-18236.383	-12947.954
-17843.07	-12874.174];

Bxy=[-17447.4	-13186.775
-17042.402	-13236.011
-16646.533	-13281.098
-16267.461	-13333.752
-15969.702	-13409.525
-15772.375	-13610.54
-15505.958	-13880.591
-15279.601	-14153.496
-15143.364	-14418.446
-15077.368	-14741.663
-15006.704	-15155.986
-14982.083	-15457.932
-15053.479	-15706.007
-15243.06	-15977.509
-15493.903	-16270.464
-15762.881	-16577.898
-16032.707	-16928.652
-16241.493	-17388.904
-16290.458	-17911.789
-16170.808	-18389.252
-15862.423	-18839.168
-15563.685	-19113.213
-15392.781	-19327.314
-15268.711	-19644.061
-15211.411	-19960.836
-15232.247	-20272.697
-15323.931	-20602.922
-15466.096	-20924.637
-15649.581	-21219.412
-15867.188	-21424.965
-16180.96	-21646.719
-16535.717	-21919.66
-16857.748	-22409.221
-16868.938	-22955.709
-16810.105	-23322.785
-16842.27	-23568.719
-16991.656	-23875.965
-17192.355	-24222.545
-17390.906	-24640.639
-17445.846	-25194.637
-17348.352	-25620.879
-17331.848	-25871.736
-17420.275	-26199.971
-17561.338	-26496.908
-17757.387	-26736.789
-18015.955	-26938.793
-18308.23	-27082.67
-18640.061	-27168.877
-18999.027	-27219.234
-19343.281	-27222.695
-19635.654	-27163.562
-19892.363	-27011.314
-20148.029	-26780.865
-20365.203	-26514.537
-20497.746	-26259.521
-20509.004	-26009.43
-20423.314	-25721.598
-20262.805	-25459.756
-20064.564	-25321.074
-19721.512	-25185.27
-19312.637	-25014.686
-18909.508	-24712.078
-18609.885	-24357.867
-18383.258	-23940.455
-18251.186	-23486.359
-18206.064	-23041.797
-18205.895	-22613.645
-18235.891	-22190.383
-18303.826	-21754.508
-18476.053	-21294.533
-18682.201	-20939.6
-18896.957	-20580.279
-19128.629	-20240.984
-19353.273	-19915
-19559.043	-19593.691
-19723.051	-19280.621
-19823.51	-18958.771
-19870.475	-18627.793
-19849.377	-18305.604
-19760.145	-17987.293
-19604.264	-17721.746
-19370.873	-17433.918
-19106.34	-17135.852
-18831.086	-16801.488
-18601.471	-16411.109
-18455.367	-15888.072
-18465.418	-15442.066
-18547.998	-14998.191
-18650.383	-14601.531
-18747.338	-14221.335
-18820.475	-13857.901
-18836.896	-13552.988
-18785.08	-13453.067
-18548.326	-13359.632
-18182.934	-13293.849
-17755.998	-13213.17];

Yamnt=size(Yxy,1); Bamnt=size(Bxy,1);
YColor=121*ones(Yamnt,1); BColor=98*ones(Bamnt,1);
BCones=[Bxy,BColor]; YCones=[Yxy,YColor];

% plot(BCones(:,1),BCones(:,2),'linew',2,'color','blue');
% hold on
% plot(YCones(:,1),YCones(:,2),'linew',2,'color','yellow');
% plot(2*BCones(:,1),2*BCones(:,2),'linew',2,'color','blue');
% plot(2*YCones(:,1),2*YCones(:,2),'linew',2,'color','yellow');
% grid on


% Frame1=[BCones(1:4,:);YCones(1:4,:)]; Frame1=Frame1(randperm(size(Frame1,1)),:);
% Frame2=[BCones(5:10,:);YCones(5:10,:)]; Frame2=Frame2(randperm(size(Frame2,1)),:);
% Frame3=[BCones(11:20,:);YCones(11:20,:)]; Frame3=Frame3(randperm(size(Frame3,1)),:);
% Frame4=[BCones(18:30,:);YCones(18:30,:)]; Frame4=Frame4(randperm(size(Frame4,1)),:);
% Frame5=[BCones(25:40,:);YCones(25:40,:)]; Frame5=Frame5(randperm(size(Frame5,1)),:);
% Frame6=[BCones(38:45,:);YCones(38:45,:)]; Frame6=Frame6(randperm(size(Frame6,1)),:);
% Frame7=[BCones(46:60,:);YCones(46:60,:)]; Frame7=Frame7(randperm(size(Frame7,1)),:);
% Frame8=[BCones(55:75,:);YCones(55:75,:)]; Frame8=Frame8(randperm(size(Frame8,1)),:);
% Frame9=[BCones(75:90,:);YCones(75:90,:)]; Frame9=Frame9(randperm(size(Frame9,1)),:);
% Frame10=[BCones(80:96,:);YCones(80:96,:)]; Frame10=Frame10(randperm(size(Frame10,1)),:);


%% finding CarCG and CarN
Ax=axes; hold(Ax,'on'); grid(Ax,'on');
scatter(Ax,Frame1(:,1),Frame1(:,2),20,'filled')
scatter(Ax,Frame2(:,1),Frame2(:,2),20,'filled')
scatter(Ax,Frame3(:,1),Frame3(:,2),20,'filled')
scatter(Ax,Frame4(:,1),Frame4(:,2),20,'filled')
scatter(Ax,Frame5(:,1),Frame5(:,2),20,'filled')
scatter(Ax,Frame6(:,1),Frame6(:,2),20,'filled')
scatter(Ax,Frame7(:,1),Frame7(:,2),20,'filled')
scatter(Ax,Frame8(:,1),Frame8(:,2),20,'filled')
scatter(Ax,Frame9(:,1),Frame9(:,2),20,'filled')
scatter(Ax,Frame10(:,1),Frame10(:,2),20,'filled')

%CarCG,CarN - 1
P=ginput(2);
CarCG1=P(2,:); %second point
CarN1=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG1(1),CarCG1(2),1e3*CarN1(1),1e3*CarN1(2));
%CarCG,CarN- 2
P=ginput(2);
CarCG2=P(2,:); %second point
CarN2=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG2(1),CarCG2(2),1e3*CarN2(1),1e3*CarN2(2));
%CarCG,CarN - 3
P=ginput(2);
CarCG3=P(2,:); %second point
CarN3=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG3(1),CarCG3(2),1e3*CarN3(1),1e3*CarN3(2));
%CarCG,CarN - 4
P=ginput(2);
CarCG4=P(2,:); %second point
CarN4=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG4(1),CarCG4(2),1e3*CarN4(1),1e3*CarN4(2));
%CarCG,CarN - 5
P=ginput(2);
CarCG5=P(2,:); %second point
CarN5=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG5(1),CarCG5(2),1e3*CarN5(1),1e3*CarN5(2));
%CarCG,CarN - 6
P=ginput(2);
CarCG6=P(2,:); %second point
CarN6=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG6(1),CarCG6(2),1e3*CarN6(1),1e3*CarN6(2));
%CarCG,CarN- 7
P=ginput(2);
CarCG7=P(2,:); %second point
CarN7=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG7(1),CarCG7(2),1e3*CarN7(1),1e3*CarN7(2));
%CarCG,CarN - 8
P=ginput(2);
CarCG8=P(2,:); %second point
CarN8=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG8(1),CarCG8(2),1e3*CarN8(1),1e3*CarN8(2));
%CarCG,CarN - 9
P=ginput(2);
CarCG9=P(2,:); %second point
CarN9=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG9(1),CarCG9(2),1e3*CarN9(1),1e3*CarN9(2));
%CarCG,CarN - 10
P=ginput(2);
CarCG10=P(2,:); %second point
CarN10=(P(1,:)-P(2,:))/norm(P(2,:)-P(1,:));
quiver(Ax,CarCG10(1),CarCG10(2),1e3*CarN10(1),1e3*CarN10(2));
%% grouping
Frames={Frame1;Frame2;Frame3;Frame4;Frame5;Frame6;Frame7;Frame8;Frame9;Frame10};
CarCG={CarCG1;CarCG2;CarCG3;CarCG4;CarCG5;CarCG6;CarCG7;CarCG8;CarCG9;CarCG10};
CarN={CarN1;CarN2;CarN3;CarN4;CarN5;CarN6;CarN7;CarN8;CarN9;CarN10};